const {
  SimpleWorkerServer
} = require('../base/common/worker/simpleWorker.js');
const {
  EditorSimpleWorker
} = require('./common/services/editorSimpleWorker.js');
let initialized = false;
function initialize(foreignModule) {
  if (initialized) {
    return;
  }
  initialized = true;
  const simpleWorker = new SimpleWorkerServer(msg => {
    globalThis.postMessage(msg);
  }, host => new EditorSimpleWorker(host, foreignModule));
  globalThis.onmessage = e => {
    simpleWorker.onmessage(e.data);
  };
}
globalThis.onmessage = e => {
  if (!initialized) {
    initialize(null);
  }
};
exports.initialize = initialize;